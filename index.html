<!DOCTYPE html>
<html lang="ru">

<!-- =========================
     BLOCK: META / TELEGRAM
========================= -->
<head>
    <meta charset="UTF-8">
    <title>Ğ¨Ğ°ÑƒÑ€Ğ¼Ğ° Ğ˜Ğ¼Ğ¿ĞµÑ€Ğ¸Ñ</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>

<!-- =========================
     BLOCK: STYLES (GLOBAL)
========================= -->
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            height: 100vh;
            background: linear-gradient(45deg, #ff6b35, #f7931e);
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            color: white;
            overflow: hidden;
        }

        .hidden { display: none; }
        .btn {
            padding: 8px 14px;
            border-radius: 20px;
            font-size: 12px;
            border: none;
            cursor: pointer;
        }
    </style>
</head>

<body>

<!-- =========================
     BLOCK: UI_HEADER
========================= -->
<header id="header" style="
    position: fixed; top: 0; left: 0; right: 0;
    height: 30px;
    background: rgba(0,0,0,0.9);
    text-align: center;
    font-size: 12px;
    line-height: 30px;
    z-index: 100;
">
    <span style="color:#ffd700;">v1.4.3</span> |
    <span id="status">Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ°...</span>
</header>

<!-- =========================
     BLOCK: UI_OVERLAY (BUTTONS / DEBUG)
========================= -->
<div style="position: fixed; top: 35px; left: 10px; z-index:101;">
    <button id="tasks-btn" class="btn" style="background:#4CAF50;">ğŸ“‹ Ğ—Ğ°Ğ´Ğ°Ğ½Ğ¸Ñ</button>
</div>

<div style="position: fixed; top: 35px; right: 10px; z-index:101;">
    <button id="reset-btn" class="btn" style="background:#ff4444;">ğŸ”„ Ğ¡Ğ±Ñ€Ğ¾Ñ</button>
</div>

<div id="debug" style="
    position: fixed; top: 70px; left: 10px;
    background: rgba(0,0,0,0.8);
    padding: 6px 10px;
    border-radius: 12px;
    font-size: 11px;
    z-index:101;
">...</div>

<!-- =========================
     BLOCK: UI_TAP_SCENE (UPGRADED)
========================= -->
<main id="tap-scene" style="
    height: 100vh;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    padding-top: 120px;
    padding-bottom: 120px;
    position: relative;
">

     <!-- =========================
          KIOSK + TAP OBJECT
     ========================= -->
     <div id="kiosk-container" style="position: relative; width:200px; height:200px; cursor: pointer;">
         <!-- ĞºĞ¸Ğ¾ÑĞº -->
         <img id="kiosk-base" src="https://i.postimg.cc/g0y54NsY/kiosk-sma.png" 
              alt="ĞšĞ¸Ğ¾ÑĞº" style="width:100%; height:100%; object-fit:contain; transition: all 0.3s;">
     
         <!-- ÑˆĞ°ÑƒÑ€Ğ¼Ğ° Ğ´Ğ»Ñ Ñ‚Ğ°Ğ¿Ğ° -->
         <img id="tap-object" src="https://i.postimg.cc/g0y54NsY/kiosk-sma.png" 
              alt="Ğ¨Ğ°ÑƒÑ€Ğ¼Ğ°" style="position:absolute; bottom:20px; left:50%; transform:translateX(-50%); width:50px; transition: transform 0.1s;">
     </div>


    <!-- STATS -->
    <div id="stats" style="
        text-align:center;
        margin-top:20px;
        font-size:22px;
        line-height: 1.5;
    ">
        <div id="count">0 ğŸ§†</div>
        <div id="dps">0 / ÑĞµĞº</div>
        <div id="tap-power">Ğ¢Ğ°Ğ¿: x1</div>
    </div>

    <!-- FLOATING +ğŸ§† EFFECT CONTAINER -->
    <div id="tap-float-container" style="
        position: absolute;
        top: 0;
        left: 50%;
        transform: translateX(-50%);
        pointer-events: none;
        width: 100%;
        height: 100%;
    "></div>

</main>


<!-- =========================
     BLOCK: UI_TASKS
========================= -->
<section id="tasks-panel" class="hidden" style="
    position: fixed; top: 110px; right: 10px;
    background: rgba(0,0,0,0.95);
    padding: 15px;
    border-radius: 15px;
    max-width: 260px;
    z-index:102;
">
    <h4>ğŸ“‹ Ğ—Ğ°Ğ´Ğ°Ğ½Ğ¸Ñ</h4>
    <div id="task-list"></div>
</section>

<!-- =========================
     BLOCK: UI_UPGRADES
========================= -->
<section id="upgrades" style="
    position: fixed; bottom: 0; left: 0; right: 0;
    background: rgba(0,0,0,0.95);
    padding: 20px;
    max-height: 35vh;
    overflow-y: auto;
">
    <h3>ğŸª ĞĞ¿Ğ³Ñ€ĞµĞ¹Ğ´Ñ‹</h3>

    <div id="tap-upgrade" class="upgrade">ğŸ‘ Ğ‘Ñ‹ÑÑ‚Ñ€Ñ‹Ğµ Ñ€ÑƒĞºĞ¸<br>
        Ğ£Ñ€. <span id="tap-level">0</span><br>
        <span id="tap-cost">50</span> ğŸ§†
    </div>

    <div id="helper-upgrade" class="upgrade">ğŸ¤– ĞŸĞ¾Ğ¼Ğ¾Ñ‰Ğ½Ğ¸Ğº<br>
        Ğ£Ñ€. <span id="helper-level">0</span><br>
        <span id="helper-cost">200</span> ğŸ§†
    </div>
</section>

<!-- =========================
     BLOCK: GAME_LOGIC
========================= -->
<script>
/* â”€â”€â”€â”€â”€â”€â”€â”€â”€ TELEGRAM â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
const tg = window.Telegram.WebApp;
tg.ready(); tg.expand();

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€ GAME STATE â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
let game = {
    version: '1.4.3',
    shaurma: 0,
    dps: 0,
    tapPower: 1,
    tapLevel: 0,
    helperLevel: 0,
    tapCost: 50,
    helperCost: 200,
    tapsCount: 0,
    tasksDone: [false,false,false]
};

const kioskLevels = [
    { minLevel: 0, src: 'https://i.postimg.cc/g0y54NsY/kiosk-sma.png' },  // Ğ¼Ğ°Ğ»ĞµĞ½ÑŒĞºĞ¸Ğ¹
    { minLevel: 5, src: 'https://i.postimg.cc/xdG7gt5n/kiosk-med.png' },  // ÑÑ€ĞµĞ´Ğ½Ğ¸Ğ¹
    { minLevel: 10, src: 'https://i.postimg.cc/xdVhKWvj/kiosk-big.png' }  // Ğ±Ğ¾Ğ»ÑŒÑˆĞ¾Ğ¹
];

function updateKioskImage() {
    let current = kioskLevels[0].src;

    // Ğ²Ñ‹Ğ±Ğ¸Ñ€Ğ°ĞµĞ¼ ĞºĞ°Ñ€Ñ‚Ğ¸Ğ½ĞºÑƒ Ğ² Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸ Ğ¾Ñ‚ ÑƒÑ€Ğ¾Ğ²Ğ½Ñ
    for (let i = 0; i < kioskLevels.length; i++) {
        if (game.tapLevel >= kioskLevels[i].minLevel) {
            current = kioskLevels[i].src;
        }
    }

    const kioskImg = document.getElementById('kiosk-base');
    if (kioskImg && kioskImg.src !== current) {
        kioskImg.src = current;

        // Ğ¿Ğ»Ğ°Ğ²Ğ½Ñ‹Ğ¹ ÑÑ„Ñ„ĞµĞºÑ‚ ÑĞ¼ĞµĞ½Ñ‹
        kioskImg.style.transition = 'opacity 0.4s';
        kioskImg.style.opacity = '0.5';
        setTimeout(() => kioskImg.style.opacity = '1', 50);
    }
}

     
/* â”€â”€â”€â”€â”€â”€â”€â”€â”€ ELEMENTS â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
const el = {
    tap: document.getElementById('tap-object'),
    count: document.getElementById('count'),
    dps: document.getElementById('dps'),
    tapPower: document.getElementById('tap-power'),
    tapLevel: document.getElementById('tap-level'),
    helperLevel: document.getElementById('helper-level'),
    tapCost: document.getElementById('tap-cost'),
    helperCost: document.getElementById('helper-cost'),
    tapUpgrade: document.getElementById('tap-upgrade'),
    helperUpgrade: document.getElementById('helper-upgrade'),
    status: document.getElementById('status'),
    debug: document.getElementById('debug'),
    reset: document.getElementById('reset-btn'),
    tasksBtn: document.getElementById('tasks-btn'),
    tasksPanel: document.getElementById('tasks-panel')
};

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€ UPDATE UI â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function update() {
    el.count.textContent = Math.floor(game.shaurma) + ' ğŸ§†';
    el.dps.textContent = game.dps + ' / ÑĞµĞº';
    el.tapPower.textContent = 'Ğ¢Ğ°Ğ¿: x' + game.tapPower;
    el.tapLevel.textContent = game.tapLevel;
    el.helperLevel.textContent = game.helperLevel;
    el.tapCost.textContent = game.tapCost;
    el.helperCost.textContent = game.helperCost;
    updateKioskImage();
    localStorage.setItem('shaurma_save', JSON.stringify(game));
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€ TAP â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
el.tap.onclick = () => {
    game.shaurma += game.tapPower;
    game.tapsCount++;
    el.tap.style.transform = 'scale(0.9)';
    setTimeout(()=>el.tap.style.transform='',100);
    tg.HapticFeedback.impactOccurred('light');
    update();
};

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€ PASSIVE â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
setInterval(()=>{
    game.shaurma += game.dps;
    update();
},1000);

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€ UPGRADES â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
el.tapUpgrade.onclick = () => {
    if (game.shaurma >= game.tapCost) {
        game.shaurma -= game.tapCost;
        game.tapLevel++;
        game.tapPower++;
        game.tapCost = Math.floor(game.tapCost * 1.15);
        update();
    }
};

el.helperUpgrade.onclick = () => {
    if (game.shaurma >= game.helperCost) {
        game.shaurma -= game.helperCost;
        game.helperLevel++;
        game.dps++;
        game.helperCost = Math.floor(game.helperCost * 1.2);
        update();
    }
};

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€ UI â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
el.reset.onclick = () => {
    localStorage.removeItem('shaurma_save');
    location.reload();
};

el.tasksBtn.onclick = () => {
    el.tasksPanel.classList.toggle('hidden');
};

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€ START â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
const saved = localStorage.getItem('shaurma_save');
if (saved) game = { ...game, ...JSON.parse(saved) };
el.status.textContent = 'Ğ“Ğ¾Ñ‚Ğ¾Ğ²Ğ¾';
update();
</script>

</body>
</html>
